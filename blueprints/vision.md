# 自然语言编程“操作系统”愿景与分层定位

本文件描述这套自然语言驱动的 AI 编程“操作系统”在文档/知识库中的愿景、范围和分层定位，帮助人类与 AI 在同一套规则下协作（业务文档目录可自定义，下文以 `workspace/` 为示例）。docs 存放蓝图与背景，langos 运行时产出后应独立可用。

## 1. 一句话定义
- 用自然语言作为操作界面，协议作为“系统调用”，让 AI 在**需求梳理 → 方案 → 编码 → 评审**四个环节形成**可控、可审计、可复用**的闭环，人工确认是默认闸门。

## 2. 覆盖范围（当前阶段）
- 覆盖：需求梳理、方案设计、编码实现、代码评审。
- 暂不覆盖：发布、运维、上线后的度量/监控等环节（后续可扩展）。
- 工作方式：自然语言→意图解析→选择协议→逐步执行，每个关键节点需人工“OK”后继续。

## 3. 分层定位与边界
- **治理层（愿景/原则/迭代方式）**  
  - 放置位置：`langos-docs/blueprints/`（本文件、meta-intro 等蓝图与背景）。  
  - 包含：愿景、基本原则、分层说明、迭代/变更策略。  
  - 不包含：具体业务需求、具体协议实现细节。
- **接口与执行层（规范/协议/运行时）**  
  - 放置位置：代码仓 `langos/runtime/`（guidelines、runtime、protocols/*）。  
  - 包含：对话与行为规范、自然语言路由与确认方式、协议定义与索引、可复用模板/checklist/片段库。  
  - 不包含：具体业务需求或仓库特有信息；运行时在无 docs 内容时也可按最小集工作。
- **业务资产层（仓库索引/需求/项目/领域知识）**  
  - 放置位置：你指定的业务文档目录/仓库（示例：`workspace/repos/`、`workspace/projects/`、`workspace/domain/`、`workspace/specs/` 等）。  
  - 包含：仓库索引与说明、跨仓库项目、需求规格、领域知识。  
  - 不包含：全局协议或对话规范。

## 4. 核心原则
- **可控**：关键操作（需求确认、方案确认、代码写入、评审结论）必须经过人工确认；协议中显式标注确认点。
- **可审计**：每步输入/输出、决策、确认要可追溯，方便回溯“为何这样决定”。
- **可复用**：协议、模板、checklist、常见片段集中沉淀，鼓励按需扩展而非临时发挥。
- **不编造**：信息不足先问清，必要假设要标注并复述确认。
- **蓝图与运行时分离**：docs 是设计与背景的蓝图，langos 运行时是独立的执行面；doc_root 仅用于按需定位文档，不是运行前置。***

## 5. 迭代与变更治理（轻量版）
- 优先小步迭代：增加小节、补充示例 > 大规模重写。重大结构调整前先给出方案再落地。
- 协议与规范变更：调整前先复述意图；若变更影响广，需在对话中显式确认后再修改对应文件（如 `protocols/*.yaml`、`guidelines`、`conventions`）。
- 向后兼容：能增补就不硬重写，避免频繁破坏习惯路径；确需破坏性变更时在相关文档说明影响。
- 记录方式：当前阶段不强制 ADR，但重要决策可择机写入 ADR（示例路径 `workspace/adr/`）以便长期追踪。

## 6. 最小闭环（当前默认流程）
- 需求梳理：结构化 spec 草稿 → 人工确认。
- 方案设计：模块/边界/数据/风险 → 人工确认。
- 编码执行：生成或修改代码+测试，写入前复述变更与影响 → 人工确认后写入/执行。
- 评审：对照 spec/方案/代码/测试，用 checklist 给出问题与结论 → 人工确认。***
